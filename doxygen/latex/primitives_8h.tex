\hypertarget{primitives_8h}{}\doxysection{kernel/arch/primitives.h File Reference}
\label{primitives_8h}\index{kernel/arch/primitives.h@{kernel/arch/primitives.h}}
{\ttfamily \#include $<$cstdalign$>$}\newline
{\ttfamily \#include $<$cstdarg$>$}\newline
{\ttfamily \#include $<$cstdint$>$}\newline
{\ttfamily \#include $<$cstddef$>$}\newline
{\ttfamily \#include $<$climits$>$}\newline
{\ttfamily \#include \char`\"{}arch/msrs.\+h\char`\"{}}\newline
Include dependency graph for primitives.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structproc__state}{proc\+\_\+state}}
\item 
struct \mbox{\hyperlink{structgdt__entry}{gdt\+\_\+entry}}
\item 
struct \mbox{\hyperlink{structidt__entry}{idt\+\_\+entry}}
\item 
struct \mbox{\hyperlink{structidt__ptr}{idt\+\_\+ptr}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{primitives_8h_a463674df467153b4399024f3825fdca8}{GDT\+\_\+\+ACC\+\_\+\+PRESENT}}~0x80
\item 
\#define \mbox{\hyperlink{primitives_8h_a44967b99f9fd4269a173742b564a9617}{GDT\+\_\+\+ACC\+\_\+\+SYS}}~0x11
\item 
\#define \mbox{\hyperlink{primitives_8h_a5761f55e89c7f930505dd2d465a5ac1e}{GDT\+\_\+\+ACC\+\_\+\+CODE}}~0x09
\item 
\#define \mbox{\hyperlink{primitives_8h_aaac57dabd1443a97443433907c8c4ed7}{GDT\+\_\+\+ACC\+\_\+\+DATA}}~0x01
\item 
\#define \mbox{\hyperlink{primitives_8h_afb39857a8010158d19e1e5833678b68c}{GDT\+\_\+\+ACC\+\_\+\+DC}}~0x04
\item 
\#define \mbox{\hyperlink{primitives_8h_a796e3f1a64a0e74a78db9872a7b585d9}{GDT\+\_\+\+ACC\+\_\+\+RW}}~0x02
\item 
\#define \mbox{\hyperlink{primitives_8h_a83c8b42aef41e3e78a62917c96050aed}{GDT\+\_\+\+FLAGS\+\_\+\+GRAN4K}}~0x80
\item 
\#define \mbox{\hyperlink{primitives_8h_a7c0392225ea228b2e9e0e7daf531fcce}{GDT\+\_\+\+FLAGS\+\_\+\+PM32}}~0x40
\item 
\#define \mbox{\hyperlink{primitives_8h_ab9107d5e65e5486f9a3bc941c8b4fa44}{GDT\+\_\+\+FLAGS\+\_\+\+LM64}}~0x20
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structgdt__entry}{gdt\+\_\+entry}} \mbox{\hyperlink{primitives_8h_a280c0c4d1ccde2fd517a7951ca937f5b}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}} ((packed))
\item 
void \mbox{\hyperlink{primitives_8h_a2bec548c1619329a6caa46677cff7dad}{\+\_\+cli}} (void)
\item 
void \mbox{\hyperlink{primitives_8h_ad9b15889d2f56638808ea71ce96ecfc7}{\+\_\+cpuid}} (struct \mbox{\hyperlink{structproc__state}{proc\+\_\+state}} $\ast$regs, uint32\+\_\+t leaf)
\item 
uint8\+\_\+t \mbox{\hyperlink{primitives_8h_af46f375b5ab4638fe3135a686f9f1785}{\+\_\+inb}} (uint16\+\_\+t port)
\item 
uint16\+\_\+t \mbox{\hyperlink{primitives_8h_ae3774964d354d3a2b200a14e887d4d0b}{\+\_\+inw}} (uint16\+\_\+t port)
\item 
uint32\+\_\+t \mbox{\hyperlink{primitives_8h_a60a77bf1986e3329a9ea45a5f5c895b4}{\+\_\+ind}} (uint16\+\_\+t port)
\item 
void \mbox{\hyperlink{primitives_8h_aef66877bb94112bdc26ac7dc8070bc33}{\+\_\+lgdt}} (struct \mbox{\hyperlink{structgdt__entry}{gdt\+\_\+entry}} $\ast$gdt, size\+\_\+t table\+\_\+size)
\item 
void \mbox{\hyperlink{primitives_8h_ad3773a6814d775159de877a4637f64c2}{\+\_\+lidt}} (struct \mbox{\hyperlink{structidt__entry}{idt\+\_\+entry}} $\ast$idt, size\+\_\+t table\+\_\+size)
\item 
void \mbox{\hyperlink{primitives_8h_abd98e81846f25cb63def44e8ba81e38e}{\+\_\+outb}} (uint16\+\_\+t port, uint8\+\_\+t val)
\item 
void \mbox{\hyperlink{primitives_8h_a7ec57dac7ab5eff6ba5206d44332ecf9}{\+\_\+outw}} (uint16\+\_\+t port, uint16\+\_\+t val)
\item 
void \mbox{\hyperlink{primitives_8h_a9c35b2b041eae0e89380a2edc14ea06e}{\+\_\+outd}} (uint16\+\_\+t port, uint32\+\_\+t val)
\item 
uint64\+\_\+t \mbox{\hyperlink{primitives_8h_a88c52250be1c074b5884baf252e2e25d}{\+\_\+rdmsr}} (uint32\+\_\+t msr)
\item 
uint64\+\_\+t \mbox{\hyperlink{primitives_8h_a1bb2948fcfb71159c7d1fcf4b9ea65de}{\+\_\+rdtsc}} (void) \mbox{\hyperlink{primitives_8h_a280c0c4d1ccde2fd517a7951ca937f5b}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}}((naked))
\item 
void \mbox{\hyperlink{primitives_8h_a01d77ec53c1430317b453e4ed13b05bb}{\+\_\+sgdt}} (struct gdt\+\_\+ptr $\ast$gdtr)
\item 
void \mbox{\hyperlink{primitives_8h_a4feeab1f9f03bd87789243f5155adb30}{\+\_\+sidt}} (struct \mbox{\hyperlink{structidt__ptr}{idt\+\_\+ptr}} $\ast$idtr)
\item 
void \mbox{\hyperlink{primitives_8h_a268babcee8f8706aa706dd6f44000e7a}{\+\_\+sti}} (void)
\item 
void \mbox{\hyperlink{primitives_8h_a527e1d6823b692711554b4fa19ce3426}{\+\_\+swapgs}} (void) \mbox{\hyperlink{primitives_8h_a280c0c4d1ccde2fd517a7951ca937f5b}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}}((naked))
\item 
void \mbox{\hyperlink{primitives_8h_a60b810810c0f4e3aca56b3ffcb89e15b}{\+\_\+syscall}} (struct \mbox{\hyperlink{structproc__state}{proc\+\_\+state}} $\ast$regs)
\item 
void \mbox{\hyperlink{primitives_8h_a6b087c4647a67974ed45dd12a20c9838}{\+\_\+wrmsr}} (uint32\+\_\+t msr, uint64\+\_\+t val)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
uint16\+\_\+t \mbox{\hyperlink{primitives_8h_a4ad5143a2c05014bf4f75a7d7cd32d3a}{limit\+\_\+lower}}
\begin{DoxyCompactList}\small\item\em lower 16 bits of the segment limit (size) \end{DoxyCompactList}\item 
uint16\+\_\+t \mbox{\hyperlink{primitives_8h_a050e451d91c8d5ffa1e2498c32362efa}{base\+\_\+lower}}
\begin{DoxyCompactList}\small\item\em lower 16 bits of the segment base \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{primitives_8h_a49136277baf1b5b2b40f27ceb9f118b7}{base\+\_\+inner\+\_\+0}}
\begin{DoxyCompactList}\small\item\em lower-\/middle 8 bits of the segment base \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{primitives_8h_aaf112ac45e75a38467735e5d53d05269}{access}}
\begin{DoxyCompactList}\small\item\em access settings and GDT segment properties \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{primitives_8h_a943fae3122db5f2a6eedd86d0c124219}{flags\+\_\+limit}}
\begin{DoxyCompactList}\small\item\em upper nibble provides additional access flags; lower nibble is upper 4 bits of limit \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{primitives_8h_a5ed9dcfe67d58e38669fa231cbdeb383}{base\+\_\+inner\+\_\+1}}
\begin{DoxyCompactList}\small\item\em upper-\/middle 8 bits of the segment base \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{primitives_8h_a89ac95fd979e6fb476782a7da2b92faa}{base\+\_\+upper}}
\begin{DoxyCompactList}\small\item\em upper 32 bits of the segment base \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{primitives_8h_aa43c4c21b173ada1b6b7568956f0d650}{reserved}}
\begin{DoxyCompactList}\small\item\em reserved field used to pad out GDT entry to 16 bytes \end{DoxyCompactList}\item 
uint16\+\_\+t \mbox{\hyperlink{primitives_8h_a8ea071f11f020022cd44c3de8cb49068}{offset\+\_\+lower}}
\begin{DoxyCompactList}\small\item\em lower 16 bits of the offset (call address) \end{DoxyCompactList}\item 
uint16\+\_\+t \mbox{\hyperlink{primitives_8h_a9a563b8f33f9e079c734090d746d1b74}{segment\+\_\+selector}}
\begin{DoxyCompactList}\small\item\em GDT selector; must match a valid/present GDT code entry. \end{DoxyCompactList}\item 
uint16\+\_\+t \mbox{\hyperlink{primitives_8h_ac5d98b39aa9ee794bf81880de1fd9bc0}{offset\+\_\+inner}}
\begin{DoxyCompactList}\small\item\em inner 16 bits of the offset (call address) \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{primitives_8h_a2ee51332803d7d0ece7960cad626682f}{offset\+\_\+upper}}
\begin{DoxyCompactList}\small\item\em upper 32 bits of the offset (call address) \end{DoxyCompactList}\item 
uint16\+\_\+t \mbox{\hyperlink{primitives_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}}
\begin{DoxyCompactList}\small\item\em size of the table \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structidt__entry}{idt\+\_\+entry}} $\ast$ \mbox{\hyperlink{primitives_8h_a09962475e46f649dfa55f5a7d5a67277}{table}}
\begin{DoxyCompactList}\small\item\em pointer to IDT (table) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{primitives_8h_a5761f55e89c7f930505dd2d465a5ac1e}\label{primitives_8h_a5761f55e89c7f930505dd2d465a5ac1e}} 
\index{primitives.h@{primitives.h}!GDT\_ACC\_CODE@{GDT\_ACC\_CODE}}
\index{GDT\_ACC\_CODE@{GDT\_ACC\_CODE}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_ACC\_CODE}{GDT\_ACC\_CODE}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+ACC\+\_\+\+CODE~0x09}

\mbox{\Hypertarget{primitives_8h_aaac57dabd1443a97443433907c8c4ed7}\label{primitives_8h_aaac57dabd1443a97443433907c8c4ed7}} 
\index{primitives.h@{primitives.h}!GDT\_ACC\_DATA@{GDT\_ACC\_DATA}}
\index{GDT\_ACC\_DATA@{GDT\_ACC\_DATA}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_ACC\_DATA}{GDT\_ACC\_DATA}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+ACC\+\_\+\+DATA~0x01}

\mbox{\Hypertarget{primitives_8h_afb39857a8010158d19e1e5833678b68c}\label{primitives_8h_afb39857a8010158d19e1e5833678b68c}} 
\index{primitives.h@{primitives.h}!GDT\_ACC\_DC@{GDT\_ACC\_DC}}
\index{GDT\_ACC\_DC@{GDT\_ACC\_DC}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_ACC\_DC}{GDT\_ACC\_DC}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+ACC\+\_\+\+DC~0x04}

\mbox{\Hypertarget{primitives_8h_a463674df467153b4399024f3825fdca8}\label{primitives_8h_a463674df467153b4399024f3825fdca8}} 
\index{primitives.h@{primitives.h}!GDT\_ACC\_PRESENT@{GDT\_ACC\_PRESENT}}
\index{GDT\_ACC\_PRESENT@{GDT\_ACC\_PRESENT}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_ACC\_PRESENT}{GDT\_ACC\_PRESENT}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+ACC\+\_\+\+PRESENT~0x80}

\mbox{\Hypertarget{primitives_8h_a796e3f1a64a0e74a78db9872a7b585d9}\label{primitives_8h_a796e3f1a64a0e74a78db9872a7b585d9}} 
\index{primitives.h@{primitives.h}!GDT\_ACC\_RW@{GDT\_ACC\_RW}}
\index{GDT\_ACC\_RW@{GDT\_ACC\_RW}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_ACC\_RW}{GDT\_ACC\_RW}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+ACC\+\_\+\+RW~0x02}

\mbox{\Hypertarget{primitives_8h_a44967b99f9fd4269a173742b564a9617}\label{primitives_8h_a44967b99f9fd4269a173742b564a9617}} 
\index{primitives.h@{primitives.h}!GDT\_ACC\_SYS@{GDT\_ACC\_SYS}}
\index{GDT\_ACC\_SYS@{GDT\_ACC\_SYS}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_ACC\_SYS}{GDT\_ACC\_SYS}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+ACC\+\_\+\+SYS~0x11}

\mbox{\Hypertarget{primitives_8h_a83c8b42aef41e3e78a62917c96050aed}\label{primitives_8h_a83c8b42aef41e3e78a62917c96050aed}} 
\index{primitives.h@{primitives.h}!GDT\_FLAGS\_GRAN4K@{GDT\_FLAGS\_GRAN4K}}
\index{GDT\_FLAGS\_GRAN4K@{GDT\_FLAGS\_GRAN4K}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_FLAGS\_GRAN4K}{GDT\_FLAGS\_GRAN4K}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+FLAGS\+\_\+\+GRAN4K~0x80}

\mbox{\Hypertarget{primitives_8h_ab9107d5e65e5486f9a3bc941c8b4fa44}\label{primitives_8h_ab9107d5e65e5486f9a3bc941c8b4fa44}} 
\index{primitives.h@{primitives.h}!GDT\_FLAGS\_LM64@{GDT\_FLAGS\_LM64}}
\index{GDT\_FLAGS\_LM64@{GDT\_FLAGS\_LM64}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_FLAGS\_LM64}{GDT\_FLAGS\_LM64}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+FLAGS\+\_\+\+LM64~0x20}

\mbox{\Hypertarget{primitives_8h_a7c0392225ea228b2e9e0e7daf531fcce}\label{primitives_8h_a7c0392225ea228b2e9e0e7daf531fcce}} 
\index{primitives.h@{primitives.h}!GDT\_FLAGS\_PM32@{GDT\_FLAGS\_PM32}}
\index{GDT\_FLAGS\_PM32@{GDT\_FLAGS\_PM32}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{GDT\_FLAGS\_PM32}{GDT\_FLAGS\_PM32}}
{\footnotesize\ttfamily \#define GDT\+\_\+\+FLAGS\+\_\+\+PM32~0x40}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{primitives_8h_a280c0c4d1ccde2fd517a7951ca937f5b}\label{primitives_8h_a280c0c4d1ccde2fd517a7951ca937f5b}} 
\index{primitives.h@{primitives.h}!\_\_attribute\_\_@{\_\_attribute\_\_}}
\index{\_\_attribute\_\_@{\_\_attribute\_\_}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_\_attribute\_\_()}{\_\_attribute\_\_()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structidt__ptr}{idt\+\_\+ptr}} \+\_\+\+\_\+attribute\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{(packed)}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a2bec548c1619329a6caa46677cff7dad}\label{primitives_8h_a2bec548c1619329a6caa46677cff7dad}} 
\index{primitives.h@{primitives.h}!\_cli@{\_cli}}
\index{\_cli@{\_cli}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_cli()}{\_cli()}}
{\footnotesize\ttfamily void \+\_\+cli (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_ad9b15889d2f56638808ea71ce96ecfc7}\label{primitives_8h_ad9b15889d2f56638808ea71ce96ecfc7}} 
\index{primitives.h@{primitives.h}!\_cpuid@{\_cpuid}}
\index{\_cpuid@{\_cpuid}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_cpuid()}{\_cpuid()}}
{\footnotesize\ttfamily void \+\_\+cpuid (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structproc__state}{proc\+\_\+state}} $\ast$}]{regs,  }\item[{uint32\+\_\+t}]{leaf }\end{DoxyParamCaption})}

Executes the {\ttfamily CPUID} processor-\/identification instruction with the {\ttfamily leaf} argument placed in {\ttfamily EAX}. The {\ttfamily CPUID} instruction is used for determination of processor capabilities and features. Depending on the specific argument placed in {\ttfamily EAX} prior to execution, the {\ttfamily CPUID} instruction will return various elements of information. These can range from vendor identification strings ({\ttfamily EAX = 00h}) to complex bitwise-\/encoded flags about instruction sets and processor caching capabilities. Intel has published an entire 128-\/page application note on this subject; for more information, see Intel Corporation (2012) AP-\/485.

There are obscure ways to test for the presence of the {\ttfamily CPUID} instruction prior to executing it, a practice which should always be performed when potentially executing an instruction for which hardware support is not explicitly known at runtime. However, all modern x86 CPUs support this instruction, and the few that do not (early model 486s and earlier) are too historical to be supported by most operating systems and the presence of {\ttfamily CPUID} can safely be assumed.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em regs} & a pointer to an instance of a processor state struct to store the output of {\ttfamily CPUID}. \\
\hline
\mbox{\texttt{ in}}  & {\em leaf} & the argument supplied to the {\ttfamily CPUID} instruction \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
struct \mbox{\hyperlink{structproc__state}{proc\+\_\+state}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{primitives_8h_af46f375b5ab4638fe3135a686f9f1785}\label{primitives_8h_af46f375b5ab4638fe3135a686f9f1785}} 
\index{primitives.h@{primitives.h}!\_inb@{\_inb}}
\index{\_inb@{\_inb}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_inb()}{\_inb()}}
{\footnotesize\ttfamily uint8\+\_\+t \+\_\+inb (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{port }\end{DoxyParamCaption})}

Reads and returns a byte value from the I/O bus location specified by {\ttfamily port}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em port} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\mbox{\Hypertarget{primitives_8h_a60a77bf1986e3329a9ea45a5f5c895b4}\label{primitives_8h_a60a77bf1986e3329a9ea45a5f5c895b4}} 
\index{primitives.h@{primitives.h}!\_ind@{\_ind}}
\index{\_ind@{\_ind}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_ind()}{\_ind()}}
{\footnotesize\ttfamily uint32\+\_\+t \+\_\+ind (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{port }\end{DoxyParamCaption})}

Reads and returns a doubleword (32-\/bit) value from the I/O bus location specified by {\ttfamily port}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em port} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\mbox{\Hypertarget{primitives_8h_ae3774964d354d3a2b200a14e887d4d0b}\label{primitives_8h_ae3774964d354d3a2b200a14e887d4d0b}} 
\index{primitives.h@{primitives.h}!\_inw@{\_inw}}
\index{\_inw@{\_inw}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_inw()}{\_inw()}}
{\footnotesize\ttfamily uint16\+\_\+t \+\_\+inw (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{port }\end{DoxyParamCaption})}

Reads and returns a word (16-\/bit) value from the I/O bus location specified by {\ttfamily port}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em port} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\mbox{\Hypertarget{primitives_8h_aef66877bb94112bdc26ac7dc8070bc33}\label{primitives_8h_aef66877bb94112bdc26ac7dc8070bc33}} 
\index{primitives.h@{primitives.h}!\_lgdt@{\_lgdt}}
\index{\_lgdt@{\_lgdt}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_lgdt()}{\_lgdt()}}
{\footnotesize\ttfamily void \+\_\+lgdt (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structgdt__entry}{gdt\+\_\+entry}} $\ast$}]{gdt,  }\item[{size\+\_\+t}]{table\+\_\+size }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_ad3773a6814d775159de877a4637f64c2}\label{primitives_8h_ad3773a6814d775159de877a4637f64c2}} 
\index{primitives.h@{primitives.h}!\_lidt@{\_lidt}}
\index{\_lidt@{\_lidt}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_lidt()}{\_lidt()}}
{\footnotesize\ttfamily void \+\_\+lidt (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structidt__entry}{idt\+\_\+entry}} $\ast$}]{idt,  }\item[{size\+\_\+t}]{table\+\_\+size }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_abd98e81846f25cb63def44e8ba81e38e}\label{primitives_8h_abd98e81846f25cb63def44e8ba81e38e}} 
\index{primitives.h@{primitives.h}!\_outb@{\_outb}}
\index{\_outb@{\_outb}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_outb()}{\_outb()}}
{\footnotesize\ttfamily void \+\_\+outb (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{port,  }\item[{uint8\+\_\+t}]{val }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a9c35b2b041eae0e89380a2edc14ea06e}\label{primitives_8h_a9c35b2b041eae0e89380a2edc14ea06e}} 
\index{primitives.h@{primitives.h}!\_outd@{\_outd}}
\index{\_outd@{\_outd}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_outd()}{\_outd()}}
{\footnotesize\ttfamily void \+\_\+outd (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{port,  }\item[{uint32\+\_\+t}]{val }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a7ec57dac7ab5eff6ba5206d44332ecf9}\label{primitives_8h_a7ec57dac7ab5eff6ba5206d44332ecf9}} 
\index{primitives.h@{primitives.h}!\_outw@{\_outw}}
\index{\_outw@{\_outw}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_outw()}{\_outw()}}
{\footnotesize\ttfamily void \+\_\+outw (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{port,  }\item[{uint16\+\_\+t}]{val }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a88c52250be1c074b5884baf252e2e25d}\label{primitives_8h_a88c52250be1c074b5884baf252e2e25d}} 
\index{primitives.h@{primitives.h}!\_rdmsr@{\_rdmsr}}
\index{\_rdmsr@{\_rdmsr}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_rdmsr()}{\_rdmsr()}}
{\footnotesize\ttfamily uint64\+\_\+t \+\_\+rdmsr (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{msr }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a1bb2948fcfb71159c7d1fcf4b9ea65de}\label{primitives_8h_a1bb2948fcfb71159c7d1fcf4b9ea65de}} 
\index{primitives.h@{primitives.h}!\_rdtsc@{\_rdtsc}}
\index{\_rdtsc@{\_rdtsc}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_rdtsc()}{\_rdtsc()}}
{\footnotesize\ttfamily uint64\+\_\+t \+\_\+rdtsc (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Reads the value of the x86 Time Stamp Counter (TSC) register (MSR 10h). Returns this value to the user as a 64-\/bit integer. This function is tagged naked to avoid the generation of function prologues and epilogues to improve accuracy when reading the TSC -\/ both registers modified by {\ttfamily RDTSC} are volatile per the System V x86-\/64 ABI and no framing occurs within. \begin{DoxySeeAlso}{See also}

\end{DoxySeeAlso}
\mbox{\Hypertarget{primitives_8h_a01d77ec53c1430317b453e4ed13b05bb}\label{primitives_8h_a01d77ec53c1430317b453e4ed13b05bb}} 
\index{primitives.h@{primitives.h}!\_sgdt@{\_sgdt}}
\index{\_sgdt@{\_sgdt}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_sgdt()}{\_sgdt()}}
{\footnotesize\ttfamily void \+\_\+sgdt (\begin{DoxyParamCaption}\item[{struct gdt\+\_\+ptr $\ast$}]{gdtr }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a4feeab1f9f03bd87789243f5155adb30}\label{primitives_8h_a4feeab1f9f03bd87789243f5155adb30}} 
\index{primitives.h@{primitives.h}!\_sidt@{\_sidt}}
\index{\_sidt@{\_sidt}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_sidt()}{\_sidt()}}
{\footnotesize\ttfamily void \+\_\+sidt (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structidt__ptr}{idt\+\_\+ptr}} $\ast$}]{idtr }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a268babcee8f8706aa706dd6f44000e7a}\label{primitives_8h_a268babcee8f8706aa706dd6f44000e7a}} 
\index{primitives.h@{primitives.h}!\_sti@{\_sti}}
\index{\_sti@{\_sti}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_sti()}{\_sti()}}
{\footnotesize\ttfamily void \+\_\+sti (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a527e1d6823b692711554b4fa19ce3426}\label{primitives_8h_a527e1d6823b692711554b4fa19ce3426}} 
\index{primitives.h@{primitives.h}!\_swapgs@{\_swapgs}}
\index{\_swapgs@{\_swapgs}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_swapgs()}{\_swapgs()}}
{\footnotesize\ttfamily void \+\_\+swapgs (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a60b810810c0f4e3aca56b3ffcb89e15b}\label{primitives_8h_a60b810810c0f4e3aca56b3ffcb89e15b}} 
\index{primitives.h@{primitives.h}!\_syscall@{\_syscall}}
\index{\_syscall@{\_syscall}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_syscall()}{\_syscall()}}
{\footnotesize\ttfamily void \+\_\+syscall (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structproc__state}{proc\+\_\+state}} $\ast$}]{regs }\end{DoxyParamCaption})}

\mbox{\Hypertarget{primitives_8h_a6b087c4647a67974ed45dd12a20c9838}\label{primitives_8h_a6b087c4647a67974ed45dd12a20c9838}} 
\index{primitives.h@{primitives.h}!\_wrmsr@{\_wrmsr}}
\index{\_wrmsr@{\_wrmsr}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{\_wrmsr()}{\_wrmsr()}}
{\footnotesize\ttfamily void \+\_\+wrmsr (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{msr,  }\item[{uint64\+\_\+t}]{val }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{primitives_8h_aaf112ac45e75a38467735e5d53d05269}\label{primitives_8h_aaf112ac45e75a38467735e5d53d05269}} 
\index{primitives.h@{primitives.h}!access@{access}}
\index{access@{access}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{access}{access}}
{\footnotesize\ttfamily uint16\+\_\+t access}



access settings and GDT segment properties 

access settings and state bits for the interrupt vector entry \mbox{\Hypertarget{primitives_8h_a49136277baf1b5b2b40f27ceb9f118b7}\label{primitives_8h_a49136277baf1b5b2b40f27ceb9f118b7}} 
\index{primitives.h@{primitives.h}!base\_inner\_0@{base\_inner\_0}}
\index{base\_inner\_0@{base\_inner\_0}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{base\_inner\_0}{base\_inner\_0}}
{\footnotesize\ttfamily uint8\+\_\+t base\+\_\+inner\+\_\+0}



lower-\/middle 8 bits of the segment base 

\mbox{\Hypertarget{primitives_8h_a5ed9dcfe67d58e38669fa231cbdeb383}\label{primitives_8h_a5ed9dcfe67d58e38669fa231cbdeb383}} 
\index{primitives.h@{primitives.h}!base\_inner\_1@{base\_inner\_1}}
\index{base\_inner\_1@{base\_inner\_1}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{base\_inner\_1}{base\_inner\_1}}
{\footnotesize\ttfamily uint8\+\_\+t base\+\_\+inner\+\_\+1}



upper-\/middle 8 bits of the segment base 

\mbox{\Hypertarget{primitives_8h_a050e451d91c8d5ffa1e2498c32362efa}\label{primitives_8h_a050e451d91c8d5ffa1e2498c32362efa}} 
\index{primitives.h@{primitives.h}!base\_lower@{base\_lower}}
\index{base\_lower@{base\_lower}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{base\_lower}{base\_lower}}
{\footnotesize\ttfamily uint16\+\_\+t base\+\_\+lower}



lower 16 bits of the segment base 

\mbox{\Hypertarget{primitives_8h_a89ac95fd979e6fb476782a7da2b92faa}\label{primitives_8h_a89ac95fd979e6fb476782a7da2b92faa}} 
\index{primitives.h@{primitives.h}!base\_upper@{base\_upper}}
\index{base\_upper@{base\_upper}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{base\_upper}{base\_upper}}
{\footnotesize\ttfamily uint32\+\_\+t base\+\_\+upper}



upper 32 bits of the segment base 

\mbox{\Hypertarget{primitives_8h_a943fae3122db5f2a6eedd86d0c124219}\label{primitives_8h_a943fae3122db5f2a6eedd86d0c124219}} 
\index{primitives.h@{primitives.h}!flags\_limit@{flags\_limit}}
\index{flags\_limit@{flags\_limit}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{flags\_limit}{flags\_limit}}
{\footnotesize\ttfamily uint8\+\_\+t flags\+\_\+limit}



upper nibble provides additional access flags; lower nibble is upper 4 bits of limit 

\mbox{\Hypertarget{primitives_8h_a4ad5143a2c05014bf4f75a7d7cd32d3a}\label{primitives_8h_a4ad5143a2c05014bf4f75a7d7cd32d3a}} 
\index{primitives.h@{primitives.h}!limit\_lower@{limit\_lower}}
\index{limit\_lower@{limit\_lower}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{limit\_lower}{limit\_lower}}
{\footnotesize\ttfamily uint16\+\_\+t limit\+\_\+lower}



lower 16 bits of the segment limit (size) 

\mbox{\Hypertarget{primitives_8h_ac5d98b39aa9ee794bf81880de1fd9bc0}\label{primitives_8h_ac5d98b39aa9ee794bf81880de1fd9bc0}} 
\index{primitives.h@{primitives.h}!offset\_inner@{offset\_inner}}
\index{offset\_inner@{offset\_inner}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{offset\_inner}{offset\_inner}}
{\footnotesize\ttfamily uint16\+\_\+t offset\+\_\+inner}



inner 16 bits of the offset (call address) 

\mbox{\Hypertarget{primitives_8h_a8ea071f11f020022cd44c3de8cb49068}\label{primitives_8h_a8ea071f11f020022cd44c3de8cb49068}} 
\index{primitives.h@{primitives.h}!offset\_lower@{offset\_lower}}
\index{offset\_lower@{offset\_lower}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{offset\_lower}{offset\_lower}}
{\footnotesize\ttfamily uint16\+\_\+t offset\+\_\+lower}



lower 16 bits of the offset (call address) 

\mbox{\Hypertarget{primitives_8h_a2ee51332803d7d0ece7960cad626682f}\label{primitives_8h_a2ee51332803d7d0ece7960cad626682f}} 
\index{primitives.h@{primitives.h}!offset\_upper@{offset\_upper}}
\index{offset\_upper@{offset\_upper}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{offset\_upper}{offset\_upper}}
{\footnotesize\ttfamily uint32\+\_\+t offset\+\_\+upper}



upper 32 bits of the offset (call address) 

\mbox{\Hypertarget{primitives_8h_aa43c4c21b173ada1b6b7568956f0d650}\label{primitives_8h_aa43c4c21b173ada1b6b7568956f0d650}} 
\index{primitives.h@{primitives.h}!reserved@{reserved}}
\index{reserved@{reserved}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{reserved}{reserved}}
{\footnotesize\ttfamily uint32\+\_\+t reserved}



reserved field used to pad out GDT entry to 16 bytes 

reserved field used to pad out IDT entry to 16 bytes \mbox{\Hypertarget{primitives_8h_a9a563b8f33f9e079c734090d746d1b74}\label{primitives_8h_a9a563b8f33f9e079c734090d746d1b74}} 
\index{primitives.h@{primitives.h}!segment\_selector@{segment\_selector}}
\index{segment\_selector@{segment\_selector}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{segment\_selector}{segment\_selector}}
{\footnotesize\ttfamily uint16\+\_\+t segment\+\_\+selector}



GDT selector; must match a valid/present GDT code entry. 

\mbox{\Hypertarget{primitives_8h_aaba88b24a21a6c70c895c0d55f4a69a0}\label{primitives_8h_aaba88b24a21a6c70c895c0d55f4a69a0}} 
\index{primitives.h@{primitives.h}!size@{size}}
\index{size@{size}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{size}{size}}
{\footnotesize\ttfamily uint16\+\_\+t size}



size of the table 

\mbox{\Hypertarget{primitives_8h_a09962475e46f649dfa55f5a7d5a67277}\label{primitives_8h_a09962475e46f649dfa55f5a7d5a67277}} 
\index{primitives.h@{primitives.h}!table@{table}}
\index{table@{table}!primitives.h@{primitives.h}}
\doxysubsubsection{\texorpdfstring{table}{table}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structidt__entry}{idt\+\_\+entry}}$\ast$ table}



pointer to IDT (table) 

